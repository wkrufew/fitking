<div>
    <style>
        .fondo {
            background-color: #000000;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25'%3E%3Cdefs%3E%3ClinearGradient id='a' gradientUnits='userSpaceOnUse' x1='0' x2='0' y1='0' y2='100%25' gradientTransform='rotate(329,768,357)'%3E%3Cstop offset='0' stop-color='%23000000'/%3E%3Cstop offset='1' stop-color='%23896B0C'/%3E%3C/linearGradient%3E%3Cpattern patternUnits='userSpaceOnUse' id='b' width='508' height='423.3' x='0' y='0' viewBox='0 0 1080 900'%3E%3Cg fill-opacity='0.1'%3E%3Cpolygon fill='%23444' points='90 150 0 300 180 300'/%3E%3Cpolygon points='90 150 180 0 0 0'/%3E%3Cpolygon fill='%23AAA' points='270 150 360 0 180 0'/%3E%3Cpolygon fill='%23DDD' points='450 150 360 300 540 300'/%3E%3Cpolygon fill='%23999' points='450 150 540 0 360 0'/%3E%3Cpolygon points='630 150 540 300 720 300'/%3E%3Cpolygon fill='%23DDD' points='630 150 720 0 540 0'/%3E%3Cpolygon fill='%23444' points='810 150 720 300 900 300'/%3E%3Cpolygon fill='%23FFF' points='810 150 900 0 720 0'/%3E%3Cpolygon fill='%23DDD' points='990 150 900 300 1080 300'/%3E%3Cpolygon fill='%23444' points='990 150 1080 0 900 0'/%3E%3Cpolygon fill='%23DDD' points='90 450 0 600 180 600'/%3E%3Cpolygon points='90 450 180 300 0 300'/%3E%3Cpolygon fill='%23666' points='270 450 180 600 360 600'/%3E%3Cpolygon fill='%23AAA' points='270 450 360 300 180 300'/%3E%3Cpolygon fill='%23DDD' points='450 450 360 600 540 600'/%3E%3Cpolygon fill='%23999' points='450 450 540 300 360 300'/%3E%3Cpolygon fill='%23999' points='630 450 540 600 720 600'/%3E%3Cpolygon fill='%23FFF' points='630 450 720 300 540 300'/%3E%3Cpolygon points='810 450 720 600 900 600'/%3E%3Cpolygon fill='%23DDD' points='810 450 900 300 720 300'/%3E%3Cpolygon fill='%23AAA' points='990 450 900 600 1080 600'/%3E%3Cpolygon fill='%23444' points='990 450 1080 300 900 300'/%3E%3Cpolygon fill='%23222' points='90 750 0 900 180 900'/%3E%3Cpolygon points='270 750 180 900 360 900'/%3E%3Cpolygon fill='%23DDD' points='270 750 360 600 180 600'/%3E%3Cpolygon points='450 750 540 600 360 600'/%3E%3Cpolygon points='630 750 540 900 720 900'/%3E%3Cpolygon fill='%23444' points='630 750 720 600 540 600'/%3E%3Cpolygon fill='%23AAA' points='810 750 720 900 900 900'/%3E%3Cpolygon fill='%23666' points='810 750 900 600 720 600'/%3E%3Cpolygon fill='%23999' points='990 750 900 900 1080 900'/%3E%3Cpolygon fill='%23999' points='180 0 90 150 270 150'/%3E%3Cpolygon fill='%23444' points='360 0 270 150 450 150'/%3E%3Cpolygon fill='%23FFF' points='540 0 450 150 630 150'/%3E%3Cpolygon points='900 0 810 150 990 150'/%3E%3Cpolygon fill='%23222' points='0 300 -90 450 90 450'/%3E%3Cpolygon fill='%23FFF' points='0 300 90 150 -90 150'/%3E%3Cpolygon fill='%23FFF' points='180 300 90 450 270 450'/%3E%3Cpolygon fill='%23666' points='180 300 270 150 90 150'/%3E%3Cpolygon fill='%23222' points='360 300 270 450 450 450'/%3E%3Cpolygon fill='%23FFF' points='360 300 450 150 270 150'/%3E%3Cpolygon fill='%23444' points='540 300 450 450 630 450'/%3E%3Cpolygon fill='%23222' points='540 300 630 150 450 150'/%3E%3Cpolygon fill='%23AAA' points='720 300 630 450 810 450'/%3E%3Cpolygon fill='%23666' points='720 300 810 150 630 150'/%3E%3Cpolygon fill='%23FFF' points='900 300 810 450 990 450'/%3E%3Cpolygon fill='%23999' points='900 300 990 150 810 150'/%3E%3Cpolygon points='0 600 -90 750 90 750'/%3E%3Cpolygon fill='%23666' points='0 600 90 450 -90 450'/%3E%3Cpolygon fill='%23AAA' points='180 600 90 750 270 750'/%3E%3Cpolygon fill='%23444' points='180 600 270 450 90 450'/%3E%3Cpolygon fill='%23444' points='360 600 270 750 450 750'/%3E%3Cpolygon fill='%23999' points='360 600 450 450 270 450'/%3E%3Cpolygon fill='%23666' points='540 600 630 450 450 450'/%3E%3Cpolygon fill='%23222' points='720 600 630 750 810 750'/%3E%3Cpolygon fill='%23FFF' points='900 600 810 750 990 750'/%3E%3Cpolygon fill='%23222' points='900 600 990 450 810 450'/%3E%3Cpolygon fill='%23DDD' points='0 900 90 750 -90 750'/%3E%3Cpolygon fill='%23444' points='180 900 270 750 90 750'/%3E%3Cpolygon fill='%23FFF' points='360 900 450 750 270 750'/%3E%3Cpolygon fill='%23AAA' points='540 900 630 750 450 750'/%3E%3Cpolygon fill='%23FFF' points='720 900 810 750 630 750'/%3E%3Cpolygon fill='%23222' points='900 900 990 750 810 750'/%3E%3Cpolygon fill='%23222' points='1080 300 990 450 1170 450'/%3E%3Cpolygon fill='%23FFF' points='1080 300 1170 150 990 150'/%3E%3Cpolygon points='1080 600 990 750 1170 750'/%3E%3Cpolygon fill='%23666' points='1080 600 1170 450 990 450'/%3E%3Cpolygon fill='%23DDD' points='1080 900 1170 750 990 750'/%3E%3C/g%3E%3C/pattern%3E%3C/defs%3E%3Crect x='0' y='0' fill='url(%23a)' width='100%25' height='100%25'/%3E%3Crect x='0' y='0' fill='url(%23b)' width='100%25' height='100%25'/%3E%3C/svg%3E");
            background-attachment: fixed;
            background-size: cover;
        }
    </style>
    <section class="fondo md:pb-8 md:mb-4 pt-16 md:pt-24 relative rounded-b-md border-b-2 border-yellow-500 select-none">
        <div class="container">
            <div class="flex-col space-y-2 py-4">
                <div class="w-full md:w-1/2 mx-auto space-y-2 py-4 text-center">
                    <h2 class="text-lg md:text-2xl text-yellow-500 font-bold">DETALLES DE LA COMPRA</h2>
                    <p class="text-white font-bolt  text-xl mb-4 hidden md:block">
                        Has tomado una buena desición al adquirir este grandioso plan y poder encontrarte con la mejor version de ti mismo.
                    </p>
                    <figure class="relative overflow-hidden z-50 block md:hidden">
                        <img class="shadow-lg rounded-lg w-full overflow-hidden h-auto object-cover border border-yellow-500" src="{{ Storage::url($plan->image->url) }}" alt="{{ $plan->title }}">
                        <div class="absolute bottom-0.5 rounded-lg left-0 text-white m-1 bg-gradient-to-t from-black w-full mx-auto">
                            <h2 class="font-bold text-sm md:text-lg uppercase text-white px-1  text-center">{{ $plan->title }}</h2>
                            <p class="font-bold text-base md:text-xl text-green-600  text-center">$ {{ $plan->price->value }}</p>
                        </div>
                    </figure>
                </div>
            </div>
    </section>

    <section>
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
            <div class="mx-auto mb-4">
                <div class="">
                    <a class="w-24 lg:w-28 flex text-neutral-300 bg-black p-2 rounded-md hover:text-yellow-500 cursor-pointer group"
                        href="{{ route('planes.show', $plan) }}">
                        <span>
                            <svg class="w-4 h-4 lg:w-6 lg:h-6 transform rotate-90 my-auto mr-2 group-hover:w-7 transition-all"
                                fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                            </svg>
                        </span>
                        <span class="text-xs lg:text-base">Regresar</span>
                    </a>
                </div>
            </div>
            <div class="bg-white shadow-lg py-2 px-4 rounded-lg mb-6 hidden md:block">
                <h2 class="text-gray-800 text-lg text-center font-bold">Paso Final de Compra</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-y-6 md:gap-x-6 mt-4">
                <div class="card order-1 md:order-2">
                    <div class="card-body">
                        <h3 class="text-gray-800 text-lg text-center font-bold">Metodos de Pago</h3>
                        <hr class="my-2">
                        <div class="py-2">
                            <a href="{{ route('payment.cash', $plan) }}" wire:target="send" wire:loading.remove
                                class=" flex justify-center transition w-full text-center py-2 sm:py-2 md:py-2.5 bg-blue-500 text-white rounded-sm shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-75">
                                <span>
                                    <i class="fa-solid fa-money-check-dollar h-6 w-auto pr-1"></i>
                                </span>
                                <span>Transferencia bancaria</span>
                            </a>
                        </div>
                        <div class="py-2 z-40">
                            <div id="paypal-button-container"></div>
                        </div>
                    </div>
                </div>
                <div class="card order-2 md:order-1">
                    <div class="card-body">
                        <div class="hidden md:block">
                            <h2 class="text-gray-800 text-lg text-center font-bold">Detalles de la compra</h2>
                            <hr class="my-2">
                            <figure>
                                <img class="shadow-lg rounded-lg w-full h-auto object-cover"
                                    src="{{ Storage::url($plan->image->url) }}" alt="">
                            </figure>
                        </div>
                        <div class="py-3 space-y-3">
                            <div class="hidden md:block">
                                <h1 class="text-gray-800 font-bold text-sm md:text-lg uppercase">{{ $plan->title }}
                                </h1>
                                <p class="font-bold text-base md:text-xl text-green-600">$ {{ $plan->price->value }}</p>
                                <hr class="my-4">
                            </div>
                            <p style="font-size: 70%" class=" text-gray-500 text-justify"><b>Nota:&nbsp;</b>
                                Al comprar el plan no se aceptarán devoluciones, debido a que la información del plan ya
                                estaría expuesta, la información
                                impartida dentro del sistema no se pueden divulgar por los términos y condiciones de
                                FitKing.<br>
                                Si compras con paypal estarás automáticamente matriculado en el plan y podrás iniciar tu
                                entrenamiento personalizado<br>
                                Si compras con mediante transferencia bancaria deberás registrarte y realizar el
                                depósito bancario y enviar el comprobante
                                a los correos oficiales y esperar 24 horas para hacer efectiva la matricula.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @push('js')
            <script src="{{ asset('//cdn.jsdelivr.net/npm/sweetalert2@11') }}"></script>
            <script
                src="https://www.paypal.com/sdk/js?client-id={{ config('services.paypal.client_id') }}&currency=USD&locale=es_EC">
            </script>
            <script>
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        return actions.order.create({
                            application_context: {
                                shipping_preference: "NO_SHIPPING"
                            },
                            payer: {
                                email_address: '{{ auth()->user()->email }}',
                                name: {
                                    given_name: '{{ auth()->user()->name }}'
                                },
                                address: {
                                    country_code: "EC"
                                }
                            },
                            purchase_units: [{
                                amount: {
                                    value: '{{ $plan->price->value }}'
                                }
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            let timerInterval
                            Swal.fire({
                                title: 'Su pago fue realizado con exito espere a ser redirigido en un momento ...',
                                /* html: 'I will close in <b></b> milliseconds.', */
                                timer: 10000,
                                timerProgressBar: true,
                                didOpen: () => {
                                    Swal.showLoading()
                                    const b = Swal.getHtmlContainer().querySelector('b')
                                    timerInterval = setInterval(() => {
                                        b.textContent = Swal.getTimerLeft()
                                    }, 100)
                                },
                                willClose: () => {
                                    clearInterval(timerInterval)
                                }
                            }).then((result) => {
                                /* Read more about handling dismissals below */
                                if (result.dismiss === Swal.DismissReason.timer) {
                                    console.log('I was closed by the timer')
                                }
                            })
                            Livewire.emit('payPlan')
                        });
                    },
                    onCancel: function(data) {
                        /* alert('Canceló el pago la orden no fue procesada.'); */
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 4000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'warning',
                            title: 'Canceló el pago la orden no fue procesada'
                        })
                    },
                    onError: (err) => {
                        /* console.error('ESTE ES UN ERROR', err); */
                        /* alert('Ocurrió un problema vuelve a intentarlo mas tarde.'); */
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 4000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'error',
                            title: 'Ocurrió un problema vuelve a intentarlo mas tarde'
                        })
                    }
                }).render('#paypal-button-container');
            </script>
        @endpush
    </section>
</div>
